/*

 xvalidate.js is just "extension" to validate.js (2.0.0) library.

 It enables:
 - defining inline rules directly on html element using standard HTML attributes,
   using data-{rule-name} attributes or just {rule-name} attributes.
 - validation while typing
 - postponing typing validation till the first submit
 - validation throttling while typing
 - displaying messages below input, above input or in some custom element.
 - enabling/disabling validation


 Copyright (c) 2015 Stanislav Zorjan, http://www.stasha.info
 xvalidatejs is open sourced under the MIT license.
*/
var xvalidatejs;
(function(k){var e;(function(a){a[a.required=0]="required";a[a.matches=1]="matches";a[a["default"]=2]="default";a[a.valid_email=3]="valid_email";a[a.valid_emails=4]="valid_emails";a[a.min_length=5]="min_length";a[a.max_length=6]="max_length";a[a.exact_length=7]="exact_length";a[a.greater_than=8]="greater_than";a[a.less_than=9]="less_than";a[a.alpha=10]="alpha";a[a.alpha_numeric=11]="alpha_numeric";a[a.alpha_dash=12]="alpha_dash";a[a.numeric=13]="numeric";a[a.integer=14]="integer";a[a.decimal=15]=
"decimal";a[a.is_natural=16]="is_natural";a[a.is_natural_no_zero=17]="is_natural_no_zero";a[a.valid_ip=18]="valid_ip";a[a.valid_base64=19]="valid_base64";a[a.valid_credit_card=20]="valid_credit_card";a[a.is_file_type=21]="is_file_type";a[a.valid_url=22]="valid_url";a[a.greater_than_date=23]="greater_than_date";a[a.less_than_date=24]="less_than_date";a[a.greater_than_or_equal_date=25]="greater_than_or_equal_date";a[a.less_than_or_equal_date=26]="less_than_or_equal_date"})(e||(e={}));var f;(function(a){a[a.name=
0]="name";a[a.display=1]="display";a[a.rules=2]="rules"})(f||(f={}));var l={date:{min:e.greater_than_date,max:e.less_than_date},number:{min:e.greater_than,max:e.less_than},"default":{min:e.min_length,max:e.max_length}},m=function(){return function(){this.errorClass="error";this.displayMessagePlacement="BELOW_INPUT";this.messagesTemplate='<ul class="validation-messages"></ul>';this.messageTemplate='<li><label for="${id}">${message}</label></li>';this.postponeKeyUpValidationTillTheFirstSubmit=!0;this.debounceKeyUpValidationInterval=
200;this.displayAllMessages=!1}}();k.Configuration=m;var n=function(){function a(a,b,d){this._configuration=new m;this._disabled=!0;this.form=a;this.fields=b;this.callback=d;this.bindValidationFunction=this.validate.bind(this);this.bindDebouncedValidationFunction=this.debounceValidateOnKeyUp.bind(this);this.createValidator();this.configuration.postponeKeyUpValidationTillTheFirstSubmit||(this.validateOnKeyUp=!0)}a.prototype.destroy=function(){delete this.fields;delete this.mergedFields;delete this.inlineFields;
delete this.callback;delete this.formValidator;this.validateOnKeyUp=!1};a.prototype.createValidator=function(){null!=this._formValidator||(this.form.attributes.getNamedItem("novalidate")||this.mergedFields&&(!this.mergedFields||this.mergedFields.length))||(this.process(),this.validationCallback=this.validationCallback||function(a,b){"function"===typeof this.callback&&this.callback(a,b);b&&b.defaultPrevented||(this.clearValidations(),0<a.length?(this.form.classList.add(this.configuration.errorClass),
this.configuration.postponeKeyUpValidationTillTheFirstSubmit&&(b&&"submit"===b.type)&&(this.validateOnKeyUp=!0),this.displayMessages(a)):0===a.length&&this.form.classList.remove(this.configuration.errorClass))},this._formValidator=new FormValidator(this.form,this.mergedFields,this.validationCallback.bind(this)))};a.prototype.displayMessages=function(a){for(var b="",d=0;d<a.length;++d){var c=a[d],e=c.element,c=c.messages;e.classList.add(this.configuration.errorClass);for(var g="",f=this.configuration.displayAllMessages?
c.length:1,h=0;h<f;++h)g+=this.configuration.messageTemplate.replace("${id}",e.id).replace("${message}",c[h]),b+=g;"ABOVE_INPUT"===this.configuration.displayMessagePlacement?e.parentNode.insertBefore(this.createMessageList(g),e.previousSibling):"BELOW_INPUT"===this.configuration.displayMessagePlacement&&e.parentNode.insertBefore(this.createMessageList(g),e.nextSibling)}"ABOVE_INPUT"!==this.configuration.displayMessagePlacement&&"BELOW_INPUT"!==this.configuration.displayMessagePlacement&&(a=document.querySelector(this.configuration.displayMessagePlacement),
null==a?console.warn("there is no element with selector "+this.configuration.displayMessagePlacement):a.appendChild(this.createMessageList(b)))};a.prototype.createMessageList=function(a){var b=document.createElement("div");b.innerHTML=this.configuration.messagesTemplate;b=b.children[0];b.innerHTML=a;return b};Object.defineProperty(a.prototype,"configuration",{get:function(){return this._configuration},set:function(a){this._configuration=a},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"validateOnKeyUp",{get:function(){return this._validateOnKeyUp},set:function(a){if(this._validateOnKeyUp!==a)this.form[a?"addEventListener":"removeEventListener"]("keyup",this.bindDebouncedValidationFunction,!0)},enumerable:!0,configurable:!0});a.prototype.debounceValidateOnKeyUp=function(){var a=this;clearInterval(this._debounceTimeout);this._debounceTimeout=setTimeout(function(){a.bindValidationFunction()},this.configuration.debounceKeyUpValidationInterval)};Object.defineProperty(a.prototype,"disabled",
{get:function(){return this._disabled},set:function(a){a!==this._disabled&&(this._disabled=a,this.formValidator.fields=this._disabled?[]:this.mergedFields)},enumerable:!0,configurable:!0});a.prototype.validate=function(){this.form.attributes.getNamedItem("novalidate")||this._formValidator._validateForm(null)};a.prototype.clearValidations=function(){for(var a=document.querySelectorAll(this.configuration.displayMessagePlacement),b=this.form.querySelectorAll("."+this.configuration.errorClass),d=this.form.querySelectorAll(".validation-messages"),
c=0;c<a.length;++c)a[c].innerHTML="";for(c=0;c<b.length;++c)b[c].classList.remove(this.configuration.errorClass);for(c=0;c<d.length;++c)d[c].parentElement.removeChild(d[c])};Object.defineProperty(a.prototype,"formValidator",{get:function(){return this._formValidator},enumerable:!0,configurable:!0});a.prototype.process=function(){this.inlineFields=[];if(null==this.form)throw'You can\'t process "null" form.';for(var a=0;a<this.form.length;++a){var b=this.processElement(this.form[a]);b&&this.inlineFields.push(b)}return this.mergedFields=
this.mergeFields(this.inlineFields,this.fields)};a.prototype.processElement=function(a){if(a.name&&"hidden"!==a.type){""==a.id&&console.warn("Error messages for the input fields without ID attribute will be grouped under single object. To avoid this behavior, assign unique ID to input element.");for(var b={name:a.name},d=0;d<a.attributes.length;++d)this.processAttribute(a.type,a.attributes[d],b);if(""===b.rules.trim())return null;b.rules=b.rules.replace("|","");return b}};a.prototype.processAttribute=
function(a,b,d){a=this.processAttributeName(a,b.name);d.rules=d.rules||"";for(var c in f)this.compare(a,c)&&("rules"===a?d.rules=""===b.value?"":b.value:d[c]=b.value);for(c in e)this.compare(a,c)&&(d.rules+="|"+(a+(""===b.value?"":"["+b.value+"]")));return d};a.prototype.processAttributeName=function(a,b){b=b.replace("data-","");b=e[(l[a]||l["default"])[b]]||b;return b.toLowerCase()};a.prototype.compare=function(a,b){a=this.convertSnakeCase(a);return this.convertSnakeCase(b)===a?!0:!1};a.prototype.convertSnakeCase=
function(a){return a.replace(/_/g,"-")};a.prototype.mergeFields=function(a,b){var d=0;a:for(;d<b.length;++d){for(var c=b[d],e=0;e<a.length;++e)if(c.name===a[e].name)continue a;a.push(c)}return a};return a}();k.Validator=n})(xvalidatejs||(xvalidatejs={}));
